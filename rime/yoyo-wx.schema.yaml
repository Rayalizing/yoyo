# Rime schema - 麓鸣-北冥
schema:
  author:
    - Rayalizing
  description: |
    麓鸣，6638字【零重码】的、字词通打、最长三码、一击顶功、极致性能的【纯形】并击输入方案,
    内置两种功法和最强指法折梅，酌情选修。
  name: "麓鸣·无相"
  schema_id: yoyo-wx
  version: 1.0

# #=============================== 
内功心法:
  __include: 小无相功  # 逍遥无崖子灌顶相授。
                      # 打法：并击主词，可随时连击，适配兼容，小而无相，精微渊深
                      # 1. 双手并击时，出词前两码，若同时打空格，则出单字前两码；
                      # 2. 单手无空格打字，直出单字编码。每打两码后第三码会顶字上屏；
                        # - 单字第三码（单字全码均为三码）由单手加空格打出，左手加空格打出⿰和⿺结构的字，右手加空格打出其他结构字；
                      # 3. 打词时，以左右不带空格为开始。之后可以选择左右再并击一次打出四码，或单手无空格依次打出第三、第四码。
                      # 4. 单手带空格打字，直出一简字/词，左右手虽指法对称，但所出一简不同，故可出字和词各120个。
指法:
  __include: yoyo:/折梅  # 逍遥派核心武学，六路折梅手包罗万有，可化用天下武功招数。
# #=============================== 

__include: yoyo:/
__patch: 
  translator/dictionary: yoyo-wx
  translator/prism: yoyo-wx
  chord_composer:
    alphabet: "12345qwertasdfgzxcvb 67890yuiophjkl;nm,./"
    prompt_format:  # 并击过程中套用的式样
      - xform/\[(..)\]/$1/g
      - xform/\((..)\)/$1/g
      - xform/[-=_+]//g
    output_format:  # 并击完成后套用的式样
      - xform|^[-=_+]([0-9]+)$|$1|  # 将纯数字还原
    algebra:
      __patch:
        - 内功心法
        - 指法

  speller:
    # auto_clear: max_length # 3种选择， manual|auto|max_length 空码按下一键确认清屏|空码自动清|达到最长码时后码顶上清屏
    # max_code_length: 6
    alphabet: "zyxwvutsrqponmlkjihgfedcba;,./ZYXWVUTSRQPONMLKJIHGFEDCBA:<>?[]()_+-='"
    initials: "zyxwvutsrqponmlkjihgfedcba;,./ZYXWVUTSRQPONMLKJIHGFEDCBA:<>?[(_+-='"
    auto_select: true
    auto_select_pattern: "'.+"  # 快符，候选唯一则顶屏
    algebra:
    # 先处理词编码(第一击由并击打出则为词)
      - xform|^([a-zA-Z;:,<.>/?]{2})([a-zA-Z;:,<.>/?]*)$|($1)$2|
      - derive|^\(([a-zA-Z;:,<.>/?]{2})\)([a-zA-Z;:,<.>/?]{2})$|($1)($2)|
      # 处理第一击之后的词编码（确保后续编码可以由串击或并击打出）
      - derive|^(\([a-zA-Z;:,<.>/?]{2}\))([a-zA-Z;:,<.>/?])|$1-$2|
      - derive|^(\([a-zA-Z;:,<.>/?]{2}\))([a-zA-Z;:,<.>/?])|$1=$2|
      - derive|^(\([a-zA-Z;:,<.>/?]{2}\)[-=][a-zA-Z;:,<.>/?])([a-zA-Z;:,<.>/?])$|$1-$2|
      - derive|^(\([a-zA-Z;:,<.>/?]{2}\)[-=][a-zA-Z;:,<.>/?])([a-zA-Z;:,<.>/?])$|$1=$2|
    # 单字前两码（使其可以由串击打出）：
      - derive|\[(.)|_$1|
      - derive|\[(.)|+$1|
      - derive|(.)\]|_$1|
      - derive|(.)\]|+$1|
    # 一简字
      - derive|^_(.)$|-$1|
      - derive|^\+(.)$|=$1|
      - derive|^_(.)$|+$1|
      - derive|^\+(.)$|_$1|

    popping:
      - match: '[_+][a-zA-Z;:,<.>/?]'
        accept: "[-=[(]"    # 已有单字第一码，打出任意 - = ( [ 中的字符则顶屏
      - match: "[[][a-zA-Z;:,<.>/?]{2}[]]"
        accept: "[_+[(]"  # 已有单字前两码（并击）, 打出任意 _ + ( [ 中的字符则顶屏
      - match: "[_+][a-zA-Z;:,<.>/?][_+][a-zA-Z;:,<.>/?]"
        accept: "[_+[(]"  # 已有单字前两码（串击）, 打出任意 _ + ( [ 中的字符则顶屏
      - match: "[(][a-zA-Z;:,<.>/?]{2}[)]"
        accept: "[_+[]"  # 已有词前两码的情况
      - match: '([_+][a-zA-Z;:,<.>/?])*[-=][a-zA-Z;:,<.>/?]'
        accept: "[^0-9 ']"    # 已有一简或单字第三码（前两码为串击）的情况
      - match: '[[][a-zA-Z;:,<.>/?]{2}[]][-=][a-zA-Z;:,<.>/?]'
        accept: "[^0-9 ']"    # 已有单字第三码（前两码为并击）的情况
      - match: '(\([a-zA-Z;:,<.>/?]{2}\)){2}'
        accept: "[^0-9 ']"   # 已有词全码(并击两次的情况)
      - match: '\([a-zA-Z;:,<.>/?]{2}\)([-=][a-zA-Z;:,<.>/?]){2}'
        accept: "[^0-9 ']"   # 已有词全码(并击+串击的情况)

小无相功:
  __append:
    # 将左右手（无空格）的按键组合：转换为  (左右)  的格式——打词
    - xform|^([12345qwertasdfgzxcvb]+)([67890yuiophjkl;nm,./]+)$|($1'$2)|
    
    # 将左右手（带空格）的按键组合：转换为  [左右]  的格式——打单字
    - xform|^(?=.*[12345qwertasdfgzxcvb])(?=.*[67890yuiophjkl;nm,./])([0-9a-z;,./]*) ([0-9a-z;,./]*)$|[$1$2]|  # 这里的 “(?=.*[12345qwertasdfgzxcvb])” 是”正向预查“：用于确保左手至少有一个按键。
    - xform|^(\[[12345qwertasdfgzxcvb]+)([67890yuiophjkl;nm,./]+\])|$1'$2|
    
    # 单手带空格：
    - xform|^(?=.*[12345qwertasdfgzxcvb])([12345qwertasdfgzxcvb]*) ([12345qwertasdfgzxcvb]*)$|-$1$2|  # 将左手1到多个按键(带空格)转换为  -左  的格式 (用于打一简和单字第三码)
    - xform|^(?=.*[67890yuiophjkl;nm,./])([67890yuiophjkl;nm,./]*) ([67890yuiophjkl;nm,./]*)$|=$1$2|  # 将右手1到多个按键(带空格)转换为  =右  的格式 (用于打一简和单字第三码)

    # 单手不带空格：
    - xform|^([12345qwertasdfgzxcvb]+)$|_$1|       # 将左手1到多个按键(不带空格)转换为  _左  的格式 (用于串击)
    - xform|^([67890yuiophjkl;nm,./]+)$|+$1|       # 将右手1到多个按键(不带空格)转换为  +右  的格式 (用于串击)


